{% extends "patient.html" %}

{% block title %}
    Clinical Trials Selector
{% endblock %}

{% block header %}
    Clinical Trials Selector
{% endblock %}

{% block pt_main %}
    <ul class="nav nav-tabs" id="myTab">
        <li class="nav-item active"><a class="nav-link active" href="#trials" data-toggle="tab">Trials</a></li>
    </ul> 
            
    <div class="tab-content">
        <div class="tab-pane active" id="trials">
            <br>
            {%- if session["trials"] %}
                <table class="custom-table">
                    <thead>
                        <tr>
                            <th>Trial Id</th>
                            <th>Title</th>
                        </tr>
                    </thead>

                    {%- for code in session["codes"] %}
                        <tbody>
                            <tr>
                                <td colspan="2" class="page-header"><button type="button" class="tbtn"><i class="fa fa-plus-circle fa-minus-circle"></i> Â  Trials for condition: {{ code["ncit_desc"] }} ({{code["ncit"]}})</button> </td>
                            </tr>
                            {%- set ns = namespace(found=false) %}
                            {%- for trial in session["trials"] %}
                                {%- if trial.code_ncit==code["ncit"] %}
                                    {%- set ns.found = true %}
                                    <tr class="toggler">
                                        <td><a href="/trial?id={{ trial.id }}">{{ trial.id }}</a></td>
                                        <td>{{ trial.title }}</td>
                                    </tr>
                                {%- endif %}
                            {%- endfor %}
                            {%- if ns.found==false %}
                                    <tr class="toggler">
                                        <td colspan=2>No eligible trials found for this condition</td>
                                    </tr>
                            {%- endif %}
                        </tbody>
                    {%- endfor %}
                </table>
            {% else %}
                <a class="btn btn-primary" href="/getInfo">Find Clinical Trials</a>
            {% endif %}
        </div><!--/tab-pane-->
    </div><!--/tab-content-->

{% endblock %}